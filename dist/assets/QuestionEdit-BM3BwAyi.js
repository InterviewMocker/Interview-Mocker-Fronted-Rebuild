import{d as F,l as M,c as a,a as t,i as _,f as T,t as u,x as w,g as b,m as n,v as k,F as h,h as V,y as i,A as K,u as $,b as E,q as d,s as N,o as l}from"./index-B1_3jWiP.js";import{l as P,i as R,o as j,p as D}from"./question-DTEubUy6.js";import{r as I}from"./ArrowLeftIcon-B7O66r4f.js";const z={class:"min-h-screen bg-gray-950 text-white p-6 lg:p-8"},A={class:"max-w-4xl mx-auto"},L={class:"mb-6 flex items-center gap-4"},O={class:"text-2xl font-bold"},G={key:0,class:"text-center py-20 text-gray-500"},H={class:"bg-gray-900 border border-gray-800 rounded-xl p-6 space-y-6"},J={class:"space-y-2"},W=["value"],X={class:"space-y-2"},Y={class:"grid md:grid-cols-3 gap-6"},Z={class:"space-y-2"},ee={class:"space-y-2"},te={class:"space-y-2"},oe={class:"bg-gray-900 border border-gray-800 rounded-xl p-6 space-y-4"},se={class:"space-y-2"},re={class:"bg-gray-900 border border-gray-800 rounded-xl p-6 space-y-6"},ae={class:"space-y-2"},ne={class:"space-y-2"},le={class:"space-y-2 mb-2"},ie={class:"flex-1 text-sm text-gray-200"},de=["onClick"],ue={class:"flex gap-2"},ce=["onKeydown"],ge={class:"bg-gray-900 border border-gray-800 rounded-xl p-6 space-y-4"},ye={class:"flex flex-wrap gap-2 mb-2"},pe=["onClick"],fe={class:"flex gap-2"},be=["onKeydown"],me={class:"flex items-center justify-end gap-4 pt-4"},xe=["disabled"],Ve=F({__name:"QuestionEdit",setup(ve){const c=$(),g=E(),m=d(!1),y=d(!1),x=d(!1),C=d([]),s=N({bank_id:"",title:"",content:"",type:"technical",difficulty:"medium",difficulty_score:5,category:"",tags:[],reference_answer:"",answer_key_points:[]}),p=d(""),f=d("");M(async()=>{try{const e=await P({page_size:100});C.value=e.data.items,g.query.bank_id&&(s.bank_id=g.query.bank_id)}catch(e){console.error("Failed to load banks:",e)}const r=g.params.id;if(r){m.value=!0,x.value=!0;try{const o=(await R(r)).data;Object.assign(s,{bank_id:o.bank_id,title:o.title,content:o.content,type:o.type,difficulty:o.difficulty,difficulty_score:o.difficulty_score||5,category:o.category||"",tags:o.tags||[],reference_answer:o.reference_answer||"",answer_key_points:o.answer_key_points||[]})}catch(e){console.error("Failed to load question:",e),c.push("/questions/banks")}finally{x.value=!1}}});function U(){var e;const r=p.value.trim();r&&!((e=s.tags)!=null&&e.includes(r))&&(s.tags||(s.tags=[]),s.tags.push(r),p.value="")}function Q(r){s.tags&&(s.tags=s.tags.filter(e=>e!==r))}function q(){const r=f.value.trim();r&&(s.answer_key_points||(s.answer_key_points=[]),s.answer_key_points.push(r),f.value="")}function S(r){s.answer_key_points&&s.answer_key_points.splice(r,1)}async function B(){if(!(!s.title||!s.content||!s.bank_id)){y.value=!0;try{m.value?await j(g.params.id,s):await D(s),c.back()}catch(r){console.error("Save failed:",r)}finally{y.value=!1}}}return(r,e)=>(l(),a("div",z,[t("div",A,[t("div",L,[t("button",{onClick:e[0]||(e[0]=o=>_(c).back()),class:"p-2 rounded-lg hover:bg-gray-900 text-gray-400 hover:text-white transition-colors"},[T(_(I),{class:"w-5 h-5"})]),t("h1",O,u(m.value?"编辑题目":"创建新题目"),1)]),x.value?(l(),a("div",G," 加载中... ")):(l(),a("form",{key:1,onSubmit:w(B,["prevent"]),class:"space-y-6"},[t("div",H,[t("div",J,[e[12]||(e[12]=t("label",{class:"text-sm font-medium text-gray-300"},[b("所属题库 "),t("span",{class:"text-red-500"},"*")],-1)),n(t("select",{"onUpdate:modelValue":e[1]||(e[1]=o=>s.bank_id=o),required:"",class:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 transition-colors"},[e[11]||(e[11]=t("option",{value:"",disabled:""},"请选择题库",-1)),(l(!0),a(h,null,V(C.value,o=>(l(),a("option",{key:o.id,value:o.id},u(o.name),9,W))),128))],512),[[k,s.bank_id]])]),t("div",X,[e[13]||(e[13]=t("label",{class:"text-sm font-medium text-gray-300"},[b("题目标题 "),t("span",{class:"text-red-500"},"*")],-1)),n(t("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>s.title=o),type:"text",required:"",placeholder:"输入题目标题",class:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 transition-colors"},null,512),[[i,s.title]])]),t("div",Y,[t("div",Z,[e[15]||(e[15]=t("label",{class:"text-sm font-medium text-gray-300"},"类型",-1)),n(t("select",{"onUpdate:modelValue":e[3]||(e[3]=o=>s.type=o),class:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 transition-colors"},[...e[14]||(e[14]=[t("option",{value:"technical"},"技术题",-1),t("option",{value:"scenario"},"场景题",-1),t("option",{value:"algorithm"},"算法题",-1),t("option",{value:"behavioral"},"行为题",-1)])],512),[[k,s.type]])]),t("div",ee,[e[17]||(e[17]=t("label",{class:"text-sm font-medium text-gray-300"},"难度",-1)),n(t("select",{"onUpdate:modelValue":e[4]||(e[4]=o=>s.difficulty=o),class:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 transition-colors"},[...e[16]||(e[16]=[t("option",{value:"easy"},"简单",-1),t("option",{value:"medium"},"中等",-1),t("option",{value:"hard"},"困难",-1)])],512),[[k,s.difficulty]])]),t("div",te,[e[18]||(e[18]=t("label",{class:"text-sm font-medium text-gray-300"},"分类",-1)),n(t("input",{"onUpdate:modelValue":e[5]||(e[5]=o=>s.category=o),type:"text",placeholder:"例如: React, Vue",class:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 transition-colors"},null,512),[[i,s.category]])])])]),t("div",oe,[t("div",se,[e[19]||(e[19]=t("label",{class:"text-sm font-medium text-gray-300"},[b("题目内容 "),t("span",{class:"text-red-500"},"*")],-1)),n(t("textarea",{"onUpdate:modelValue":e[6]||(e[6]=o=>s.content=o),required:"",rows:"8",placeholder:"输入详细的题目描述...",class:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 transition-colors"},null,512),[[i,s.content]])])]),t("div",re,[t("div",ae,[e[20]||(e[20]=t("label",{class:"text-sm font-medium text-gray-300"},"参考答案",-1)),n(t("textarea",{"onUpdate:modelValue":e[7]||(e[7]=o=>s.reference_answer=o),rows:"6",placeholder:"输入参考答案...",class:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 transition-colors"},null,512),[[i,s.reference_answer]])]),t("div",ne,[e[21]||(e[21]=t("label",{class:"text-sm font-medium text-gray-300"},"得分要点",-1)),t("div",le,[(l(!0),a(h,null,V(s.answer_key_points,(o,v)=>(l(),a("div",{key:v,class:"flex items-center gap-2 bg-gray-800 px-3 py-2 rounded-lg border border-gray-700"},[t("span",ie,u(o),1),t("button",{onClick:_e=>S(v),type:"button",class:"text-gray-500 hover:text-red-400"},"×",8,de)]))),128))]),t("div",ue,[n(t("input",{"onUpdate:modelValue":e[8]||(e[8]=o=>f.value=o),onKeydown:K(w(q,["prevent"]),["enter"]),type:"text",placeholder:"添加得分要点 (按回车)",class:"flex-1 bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 transition-colors"},null,40,ce),[[i,f.value]]),t("button",{onClick:q,type:"button",class:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white border border-gray-700 rounded-lg transition-colors"}," 添加 ")])])]),t("div",ge,[e[22]||(e[22]=t("label",{class:"text-sm font-medium text-gray-300"},"标签",-1)),t("div",ye,[(l(!0),a(h,null,V(s.tags,o=>(l(),a("span",{key:o,class:"px-3 py-1 bg-emerald-900/30 text-emerald-400 border border-emerald-800/50 rounded-full text-sm flex items-center gap-2"},[b(u(o)+" ",1),t("button",{onClick:v=>Q(o),type:"button",class:"hover:text-white"},"×",8,pe)]))),128))]),t("div",fe,[n(t("input",{"onUpdate:modelValue":e[9]||(e[9]=o=>p.value=o),onKeydown:K(w(U,["prevent"]),["enter"]),type:"text",placeholder:"添加标签 (按回车)",class:"flex-1 bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 transition-colors"},null,40,be),[[i,p.value]]),t("button",{onClick:U,type:"button",class:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white border border-gray-700 rounded-lg transition-colors"}," 添加 ")])]),t("div",me,[t("button",{type:"button",onClick:e[10]||(e[10]=o=>_(c).back()),class:"px-6 py-2.5 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors border border-gray-700"}," 取消 "),t("button",{type:"submit",disabled:y.value,class:"px-6 py-2.5 bg-emerald-500 hover:bg-emerald-600 text-white rounded-lg font-medium shadow-lg shadow-emerald-500/20 transition-all disabled:opacity-50 disabled:cursor-not-allowed"},u(y.value?"保存中...":"保存题目"),9,xe)])],32))])]))}});export{Ve as default};
