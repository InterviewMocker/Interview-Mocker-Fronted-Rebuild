import{d as N,k as T,l as A,c as l,a as s,f as u,i as c,n as k,g as h,p as g,m as F,v as Q,F as b,h as x,b as S,q as p,s as j,u as E,o as n,t as L,C as M}from"./index-B1_3jWiP.js";import{l as R,a as P,d as U,b as G,c as H}from"./question-DTEubUy6.js";import{r as I,_ as J}from"./QuestionBankCard.vue_vue_type_script_setup_true_lang-DHONf-9o.js";import{r as K}from"./PlusIcon-OubMv-v3.js";import{r as O}from"./UserIcon-DaUz5X_1.js";import{r as W}from"./XCircleIcon-wm93KZle.js";import{r as X}from"./MagnifyingGlassIcon-16jXXFvc.js";import"./ClockIcon-Sdcm571c.js";import"./PencilIcon-Cx_SwFD1.js";import"./TrashIcon-dWnjABfe.js";const Y={class:"min-h-screen p-6 lg:p-8"},Z={class:"max-w-7xl mx-auto space-y-8 animate-fade-in"},ee={class:"flex flex-col md:flex-row md:items-center justify-between gap-4"},te={class:"flex gap-4 border-b border-white/10"},se={class:"flex items-center gap-2"},ae={key:0,class:"absolute bottom-0 left-0 w-full h-0.5 bg-primary-500 rounded-t-full"},oe={class:"flex items-center gap-2"},re={key:0,class:"absolute bottom-0 left-0 w-full h-0.5 bg-primary-500 rounded-t-full"},ne={class:"glass-nav rounded-xl p-4 border border-white/5 flex flex-wrap items-center gap-4"},le={class:"flex items-center gap-2 text-gray-400"},ie=["value"],de={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},ue={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},ce={key:2,class:"text-center py-20 text-gray-500"},me={key:3,class:"flex justify-center gap-2 mt-8"},pe=["disabled"],ye=["disabled"],Be=N({__name:"QuestionBankList",setup(fe){const m=E(),w=S(),o=p("my"),y=p([]),f=p(0),v=p(!1),r=j({page:1,page_size:12,category:""}),_=[{label:"全部",value:""},{label:"前端",value:"frontend"},{label:"后端",value:"backend"},{label:"算法",value:"algorithm"},{label:"系统设计",value:"system"}];T(o,()=>{r.page=1,i()});async function i(){v.value=!0;try{const e=await(o.value==="my"?R:P)(r);y.value=e.data.items,f.value=e.data.total}catch(a){console.error("Failed to fetch question banks:",a)}finally{v.value=!1}}function C(){r.page=1,i()}function $(a){o.value==="community"?m.push(`/questions/banks/${a}`):m.push(`/questions/banks/${a}`)}function B(){m.push("/questions/banks/create")}function q(a){m.push(`/questions/banks/${a}/edit`)}async function D(a){if(confirm("确定要删除该题库吗？这将同时删除其中的所有题目！"))try{await U(a),i()}catch(e){console.error("Delete failed:",e)}}async function V(a){var e,t;if(confirm("确定要申请将该题库上架到社区吗？需要管理员审核通过后其他人才可见。"))try{await G(a),alert("申请已提交，请等待管理员审核"),i()}catch(d){console.error("Apply failed:",d),alert(((t=(e=d.response)==null?void 0:e.data)==null?void 0:t.message)||"申请失败")}}async function z(a){var e,t;if(confirm("确定要复制该题库到我的题库吗？"))try{await H(a),alert('复制成功！已添加到"我的题库"')}catch(d){console.error("Copy failed:",d),alert(((t=(e=d.response)==null?void 0:e.data)==null?void 0:t.message)||"复制失败")}}return A(()=>{w.query.tab==="community"&&(o.value="community"),i()}),(a,e)=>(n(),l("div",Y,[s("div",Z,[s("div",ee,[e[6]||(e[6]=s("div",null,[s("h1",{class:"text-3xl font-bold text-gradient"}," 题库管理 "),s("p",{class:"text-gray-400 mt-1"},"管理个人题库与探索社区资源")],-1)),s("button",{onClick:B,class:"btn-primary flex items-center gap-2"},[u(c(K),{class:"w-5 h-5"}),e[5]||(e[5]=s("span",null,"新建题库",-1))])]),s("div",te,[s("button",{onClick:e[0]||(e[0]=t=>o.value="my"),class:k(["pb-3 px-4 text-sm font-medium transition-colors relative",o.value==="my"?"text-primary-400":"text-gray-400 hover:text-gray-200"])},[s("div",se,[u(c(O),{class:"w-5 h-5"}),e[7]||(e[7]=h(" 我的题库 ",-1))]),o.value==="my"?(n(),l("div",ae)):g("",!0)],2),s("button",{onClick:e[1]||(e[1]=t=>o.value="community"),class:k(["pb-3 px-4 text-sm font-medium transition-colors relative",o.value==="community"?"text-primary-400":"text-gray-400 hover:text-gray-200"])},[s("div",oe,[u(c(W),{class:"w-5 h-5"}),e[8]||(e[8]=h(" 社区题库 ",-1))]),o.value==="community"?(n(),l("div",re)):g("",!0)],2)]),s("div",ne,[s("div",le,[u(c(X),{class:"w-5 h-5"}),e[9]||(e[9]=s("span",{class:"text-sm font-medium"},"筛选：",-1))]),F(s("select",{"onUpdate:modelValue":e[2]||(e[2]=t=>r.category=t),onChange:C,class:"bg-dark-900/50 border border-white/10 text-white text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block p-2.5 outline-none backdrop-blur-sm transition-all hover:border-white/20"},[(n(),l(b,null,x(_,t=>s("option",{key:t.value,value:t.value},L(t.label||"全部分类"),9,ie)),64))],544),[[Q,r.category]])]),v.value?(n(),l("div",de,[(n(),l(b,null,x(6,t=>s("div",{key:t,class:"h-48 bg-dark-900/50 rounded-xl animate-pulse border border-white/5"})),64))])):y.value.length>0?(n(),l("div",ue,[(n(!0),l(b,null,x(y.value,t=>(n(),M(J,{key:t.id,bank:t,"is-community-view":o.value==="community",onClick:d=>$(t.id),onEdit:q,onDelete:D,onApply:V,onCopy:z},null,8,["bank","is-community-view","onClick"]))),128))])):(n(),l("div",ce,[u(c(I),{class:"w-16 h-16 mx-auto mb-4 opacity-20"}),e[10]||(e[10]=s("p",null,"暂无题库",-1))])),f.value>r.page_size?(n(),l("div",me,[s("button",{disabled:r.page===1,onClick:e[3]||(e[3]=t=>{r.page--,i()}),class:"btn-secondary px-4 py-2 text-sm disabled:opacity-50 disabled:cursor-not-allowed"}," 上一页 ",8,pe),s("button",{disabled:r.page*r.page_size>=f.value,onClick:e[4]||(e[4]=t=>{r.page++,i()}),class:"btn-secondary px-4 py-2 text-sm disabled:opacity-50 disabled:cursor-not-allowed"}," 下一页 ",8,ye)])):g("",!0)])]))}});export{Be as default};
