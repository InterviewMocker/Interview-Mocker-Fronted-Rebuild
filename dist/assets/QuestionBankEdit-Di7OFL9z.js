import{d as _,l as V,c as r,a as t,i as m,f as B,t as y,x as v,g as h,m as u,y as f,v as C,z as S,F as q,h as M,A as N,u as Q,b as T,q as c,s as U,o as n}from"./index-B1_3jWiP.js";import{g as E,u as F,e as K}from"./question-DTEubUy6.js";import{r as $}from"./ArrowLeftIcon-B7O66r4f.js";const z={class:"min-h-screen bg-gray-950 text-white p-6 lg:p-8"},D={class:"max-w-2xl mx-auto"},R={class:"mb-6 flex items-center gap-4"},j={class:"text-2xl font-bold"},A={key:0,class:"text-center py-20 text-gray-500"},I={class:"bg-gray-900 border border-gray-800 rounded-xl p-6 space-y-6"},L={class:"space-y-2"},G={class:"space-y-2"},H={class:"space-y-2"},J={class:"space-y-2"},O={class:"flex flex-wrap gap-2 mb-2"},P=["onClick"],W={class:"flex gap-2"},X=["onKeydown"],Y={class:"flex items-center justify-end gap-4 pt-4"},Z=["disabled"],re=_({__name:"QuestionBankEdit",setup(ee){const l=Q(),b=T(),g=c(!1),i=c(!1),p=c(!1),o=U({name:"",description:"",category:"",tags:[]}),d=c("");V(async()=>{const a=b.params.id;if(a){g.value=!0,p.value=!0;try{const s=(await E(a)).data;o.name=s.name,o.description=s.description||"",o.category=s.category||"",o.tags=s.tags||[]}catch(e){console.error("Failed to load bank:",e),l.push("/questions/banks")}finally{p.value=!1}}});function x(){var e;const a=d.value.trim();a&&!((e=o.tags)!=null&&e.includes(a))&&(o.tags||(o.tags=[]),o.tags.push(a),d.value="")}function w(a){o.tags&&(o.tags=o.tags.filter(e=>e!==a))}async function k(){if(o.name){i.value=!0;try{g.value?await F(b.params.id,o):await K(o),l.push("/questions/banks")}catch(a){console.error("Save failed:",a)}finally{i.value=!1}}}return(a,e)=>(n(),r("div",z,[t("div",D,[t("div",R,[t("button",{onClick:e[0]||(e[0]=s=>m(l).back()),class:"p-2 rounded-lg hover:bg-gray-900 text-gray-400 hover:text-white transition-colors"},[B(m($),{class:"w-5 h-5"})]),t("h1",j,y(g.value?"编辑题库":"创建新题库"),1)]),p.value?(n(),r("div",A," 加载中... ")):(n(),r("form",{key:1,onSubmit:v(k,["prevent"]),class:"space-y-6"},[t("div",I,[t("div",L,[e[6]||(e[6]=t("label",{class:"text-sm font-medium text-gray-300"},[h("题库名称 "),t("span",{class:"text-red-500"},"*")],-1)),u(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>o.name=s),type:"text",required:"",placeholder:"输入题库名称",class:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 transition-colors"},null,512),[[f,o.name]])]),t("div",G,[e[8]||(e[8]=t("label",{class:"text-sm font-medium text-gray-300"},"分类",-1)),u(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>o.category=s),class:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 transition-colors"},[...e[7]||(e[7]=[S('<option value="">请选择</option><option value="frontend">前端</option><option value="backend">后端</option><option value="algorithm">算法</option><option value="system">系统设计</option>',5)])],512),[[C,o.category]])]),t("div",H,[e[9]||(e[9]=t("label",{class:"text-sm font-medium text-gray-300"},"描述",-1)),u(t("textarea",{"onUpdate:modelValue":e[3]||(e[3]=s=>o.description=s),rows:"4",placeholder:"简短的题库描述...",class:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 transition-colors resize-none"},null,512),[[f,o.description]])]),t("div",J,[e[10]||(e[10]=t("label",{class:"text-sm font-medium text-gray-300"},"标签",-1)),t("div",O,[(n(!0),r(q,null,M(o.tags,s=>(n(),r("span",{key:s,class:"px-3 py-1 bg-emerald-900/30 text-emerald-400 border border-emerald-800/50 rounded-full text-sm flex items-center gap-2"},[h(y(s)+" ",1),t("button",{onClick:te=>w(s),type:"button",class:"hover:text-white"},"×",8,P)]))),128))]),t("div",W,[u(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>d.value=s),onKeydown:N(v(x,["prevent"]),["enter"]),type:"text",placeholder:"添加标签 (按回车)",class:"flex-1 bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 transition-colors"},null,40,X),[[f,d.value]]),t("button",{onClick:x,type:"button",class:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white border border-gray-700 rounded-lg transition-colors"}," 添加 ")])])]),t("div",Y,[t("button",{type:"button",onClick:e[5]||(e[5]=s=>m(l).back()),class:"px-6 py-2.5 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors border border-gray-700"}," 取消 "),t("button",{type:"submit",disabled:i.value,class:"px-6 py-2.5 bg-emerald-500 hover:bg-emerald-600 text-white rounded-lg font-medium shadow-lg shadow-emerald-500/20 transition-all disabled:opacity-50 disabled:cursor-not-allowed"},y(i.value?"保存中...":"保存题库"),9,Z)])],32))])]))}});export{re as default};
