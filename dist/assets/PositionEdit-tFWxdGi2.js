import{d as U,l as S,c as n,a as o,i as f,f as C,t as b,x as _,g as y,m as l,y as i,v as x,z as q,F as $,h as j,A as B,u as D,b as M,j as N,q as v,s as P,o as a}from"./index-B1_3jWiP.js";import{g as z,u as E,c as F}from"./position-DiI746tR.js";import{r as K}from"./ArrowLeftIcon-B7O66r4f.js";const L={class:"min-h-screen bg-gray-950 text-white p-6 lg:p-8"},R={class:"max-w-3xl mx-auto"},T={class:"mb-6 flex items-center gap-4"},A={class:"text-2xl font-bold"},I={key:0,class:"text-center py-20 text-gray-500"},O={class:"bg-gray-900 border border-gray-800 rounded-xl p-6 space-y-6"},G={class:"grid md:grid-cols-2 gap-6"},H={class:"space-y-2"},J={class:"space-y-2"},Q=["disabled"],W={class:"grid md:grid-cols-3 gap-6"},X={class:"space-y-2"},Y={class:"space-y-2"},Z={class:"space-y-2"},ee={class:"space-y-2"},oe={class:"bg-gray-900 border border-gray-800 rounded-xl p-6 space-y-6"},te={class:"space-y-2"},se={class:"space-y-2"},re={class:"flex flex-wrap gap-2 mb-2"},le=["onClick"],ie={class:"flex gap-2"},ne=["onKeydown"],ae={class:"bg-gray-900 border border-gray-800 rounded-xl p-6 space-y-6"},de={class:"grid md:grid-cols-2 gap-6"},ue={class:"space-y-2"},pe={class:"space-y-2"},ce={class:"flex items-center justify-end gap-4"},ge=["disabled"],ve=U({__name:"PositionEdit",setup(me){const d=D(),g=M(),u=N(()=>!!g.params.id),p=v(!1),m=v(!1),s=P({name:"",code:"",category:"",description:"",requirements:"",required_skills:[],skill_weights:{},difficulty_level:"mid",education_requirement:"本科",default_question_count:10,default_duration:30}),c=v("");S(async()=>{const r=g.params.id;if(r){m.value=!0;try{const t=(await z(r)).data;Object.assign(s,{name:t.name,code:t.code,category:t.category||"",description:t.description||"",requirements:"",required_skills:t.required_skills||[],difficulty_level:t.difficulty_level||"mid",education_requirement:t.education_requirement||"本科",default_question_count:t.default_question_count,default_duration:t.default_duration})}catch(e){console.error("Failed to load position:",e),d.push("/positions")}finally{m.value=!1}}});function k(){s.name&&!s.code&&!u.value&&(s.code=s.name.toLowerCase().replace(/[\u4e00-\u9fa5]/g,r=>"p").replace(/[^a-z0-9]/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"")||`pos-${Date.now().toString(36)}`)}function w(){var e;const r=c.value.trim();r&&!((e=s.required_skills)!=null&&e.includes(r))&&(s.required_skills||(s.required_skills=[]),s.required_skills.push(r),c.value="")}function h(r){s.required_skills&&(s.required_skills=s.required_skills.filter(e=>e!==r))}async function V(){var r,e;if(!(!s.name||!s.code)){p.value=!0;try{if(u.value){const t={...s};delete t.code,await E(g.params.id,t)}else await F(s);d.push("/positions")}catch(t){console.error("Save failed:",t),alert(((e=(r=t.response)==null?void 0:r.data)==null?void 0:e.message)||"保存失败")}finally{p.value=!1}}}return(r,e)=>(a(),n("div",L,[o("div",R,[o("div",T,[o("button",{onClick:e[0]||(e[0]=t=>f(d).back()),class:"p-2 rounded-lg hover:bg-gray-900 text-gray-400 hover:text-white transition-colors"},[C(f(K),{class:"w-5 h-5"})]),o("h1",A,b(u.value?"编辑岗位":"创建新岗位"),1)]),m.value?(a(),n("div",I," 加载中... ")):(a(),n("form",{key:1,onSubmit:_(V,["prevent"]),class:"space-y-8"},[o("section",O,[e[21]||(e[21]=o("h2",{class:"text-lg font-semibold text-white border-b border-gray-800 pb-4"},"基本信息",-1)),o("div",G,[o("div",H,[e[12]||(e[12]=o("label",{class:"text-sm font-medium text-gray-300"},[y("岗位名称 "),o("span",{class:"text-red-500"},"*")],-1)),l(o("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>s.name=t),onBlur:k,type:"text",required:"",placeholder:"例如：高级前端开发工程师",class:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 transition-colors"},null,544),[[i,s.name]])]),o("div",J,[e[13]||(e[13]=o("label",{class:"text-sm font-medium text-gray-300"},[y("岗位编码 "),o("span",{class:"text-red-500"},"*")],-1)),l(o("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>s.code=t),type:"text",required:"",disabled:u.value,placeholder:"例如：senior-frontend-dev",class:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},null,8,Q),[[i,s.code]])])]),o("div",W,[o("div",X,[e[15]||(e[15]=o("label",{class:"text-sm font-medium text-gray-300"},"分类",-1)),l(o("select",{"onUpdate:modelValue":e[3]||(e[3]=t=>s.category=t),class:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 transition-colors"},[...e[14]||(e[14]=[q('<option value="">请选择</option><option value="技术类">技术类</option><option value="产品类">产品类</option><option value="运营类">运营类</option><option value="设计类">设计类</option><option value="市场类">市场类</option>',6)])],512),[[x,s.category]])]),o("div",Y,[e[17]||(e[17]=o("label",{class:"text-sm font-medium text-gray-300"},"难度等级",-1)),l(o("select",{"onUpdate:modelValue":e[4]||(e[4]=t=>s.difficulty_level=t),class:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 transition-colors"},[...e[16]||(e[16]=[o("option",{value:"junior"},"初级",-1),o("option",{value:"mid"},"中级",-1),o("option",{value:"senior"},"高级",-1),o("option",{value:"expert"},"专家",-1)])],512),[[x,s.difficulty_level]])]),o("div",Z,[e[19]||(e[19]=o("label",{class:"text-sm font-medium text-gray-300"},"学历要求",-1)),l(o("select",{"onUpdate:modelValue":e[5]||(e[5]=t=>s.education_requirement=t),class:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 transition-colors"},[...e[18]||(e[18]=[q('<option value="不限">不限</option><option value="大专">大专</option><option value="本科">本科</option><option value="硕士">硕士</option><option value="博士">博士</option>',5)])],512),[[x,s.education_requirement]])])]),o("div",ee,[e[20]||(e[20]=o("label",{class:"text-sm font-medium text-gray-300"},"岗位描述",-1)),l(o("textarea",{"onUpdate:modelValue":e[6]||(e[6]=t=>s.description=t),rows:"3",placeholder:"简短的岗位职责描述...",class:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 transition-colors resize-none"},null,512),[[i,s.description]])])]),o("section",oe,[e[24]||(e[24]=o("h2",{class:"text-lg font-semibold text-white border-b border-gray-800 pb-4"},"要求与技能",-1)),o("div",te,[e[22]||(e[22]=o("label",{class:"text-sm font-medium text-gray-300"},"详细要求",-1)),l(o("textarea",{"onUpdate:modelValue":e[7]||(e[7]=t=>s.requirements=t),rows:"6",placeholder:"详细的任职要求...",class:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 transition-colors"},null,512),[[i,s.requirements]])]),o("div",se,[e[23]||(e[23]=o("label",{class:"text-sm font-medium text-gray-300"},"必备技能",-1)),o("div",re,[(a(!0),n($,null,j(s.required_skills,t=>(a(),n("span",{key:t,class:"px-3 py-1 bg-emerald-900/30 text-emerald-400 border border-emerald-800/50 rounded-full text-sm flex items-center gap-2"},[y(b(t)+" ",1),o("button",{onClick:fe=>h(t),type:"button",class:"hover:text-white"},"×",8,le)]))),128))]),o("div",ie,[l(o("input",{"onUpdate:modelValue":e[8]||(e[8]=t=>c.value=t),onKeydown:B(_(w,["prevent"]),["enter"]),type:"text",placeholder:"添加技能 (按回车)",class:"flex-1 bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 transition-colors"},null,40,ne),[[i,c.value]]),o("button",{onClick:w,type:"button",class:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white border border-gray-700 rounded-lg transition-colors"}," 添加 ")])])]),o("section",ae,[e[27]||(e[27]=o("h2",{class:"text-lg font-semibold text-white border-b border-gray-800 pb-4"},"面试配置",-1)),o("div",de,[o("div",ue,[e[25]||(e[25]=o("label",{class:"text-sm font-medium text-gray-300"},"默认题目数量",-1)),l(o("input",{"onUpdate:modelValue":e[9]||(e[9]=t=>s.default_question_count=t),type:"number",min:"1",max:"50",class:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 transition-colors"},null,512),[[i,s.default_question_count,void 0,{number:!0}]])]),o("div",pe,[e[26]||(e[26]=o("label",{class:"text-sm font-medium text-gray-300"},"默认时长 (分钟)",-1)),l(o("input",{"onUpdate:modelValue":e[10]||(e[10]=t=>s.default_duration=t),type:"number",min:"5",max:"180",class:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 transition-colors"},null,512),[[i,s.default_duration,void 0,{number:!0}]])])])]),o("div",ce,[o("button",{type:"button",onClick:e[11]||(e[11]=t=>f(d).back()),class:"px-6 py-2.5 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors border border-gray-700"}," 取消 "),o("button",{type:"submit",disabled:p.value,class:"px-6 py-2.5 bg-emerald-500 hover:bg-emerald-600 text-white rounded-lg font-medium shadow-lg shadow-emerald-500/20 transition-all disabled:opacity-50 disabled:cursor-not-allowed"},b(p.value?"保存中...":"保存岗位"),9,ge)])],32))])]))}});export{ve as default};
