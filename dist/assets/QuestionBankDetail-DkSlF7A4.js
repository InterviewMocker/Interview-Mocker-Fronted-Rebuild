import{c as s,a as e,o,d as oe,l as re,f as c,w as ae,i,t as l,g as m,p as d,F as y,h as v,m as X,v as Y,u as le,b as ne,q as x,s as ie,r as de,n as ue,x as ce,_ as pe}from"./index-B1_3jWiP.js";import{g as ge,f as ye,h as xe,i as me}from"./question-DTEubUy6.js";import{r as ve}from"./UserIcon-DaUz5X_1.js";import{r as fe}from"./ClockIcon-Sdcm571c.js";import{r as be}from"./CloudArrowUpIcon-ClIo6N5m.js";import{r as he}from"./PlusIcon-OubMv-v3.js";import{r as _e}from"./MagnifyingGlassIcon-16jXXFvc.js";import{r as Z}from"./PencilIcon-Cx_SwFD1.js";import{r as q}from"./TrashIcon-dWnjABfe.js";function we(V,f){return o(),s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"})])}function ke(V,f){return o(),s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18 18 6M6 6l12 12"})])}const Ce={class:"min-h-screen bg-gray-950 text-white p-6 lg:p-8"},$e={class:"max-w-7xl mx-auto space-y-8"},De={class:"space-y-4"},Be={class:"flex items-center gap-2 text-sm text-gray-400"},Qe={class:"text-white"},je={class:"flex flex-col md:flex-row md:items-center justify-between gap-4"},Me={class:"text-3xl font-bold text-white flex items-center gap-3"},Ve={key:0,class:"px-2 py-1 rounded text-xs font-bold bg-primary-500 text-white shadow-lg shadow-primary-500/30"},ze={class:"flex items-center gap-4 mt-2 text-sm text-gray-400"},Fe={key:0,class:"flex items-center gap-1"},Ne={key:1,class:"flex items-center gap-1"},Se={class:"text-gray-400 mt-2"},Ie={key:0,class:"flex flex-wrap gap-2 mt-3"},Le={class:"flex gap-3"},Re={class:"flex flex-wrap items-center gap-4 bg-gray-900/50 p-4 rounded-xl border border-gray-800"},Te={class:"flex items-center gap-2 text-gray-400"},Ue=["value"],Ee={key:0,class:"text-center py-20 text-gray-500"},Pe={key:1,class:"bg-gray-900 border border-gray-800 rounded-xl overflow-hidden"},Ae={class:"overflow-x-auto"},Ge={class:"w-full text-left"},He={class:"divide-y divide-gray-800"},Je=["onClick"],Ke={class:"px-6 py-4"},Oe={class:"font-medium text-white mb-1"},We={key:0,class:"flex gap-2"},Xe={class:"px-6 py-4"},Ye={class:"text-sm text-gray-300"},Ze={class:"px-6 py-4"},qe={class:"px-6 py-4 text-right"},et=["onClick"],tt=["onClick"],st={key:2,class:"text-center py-20 text-gray-500"},ot={key:3,class:"flex justify-center gap-2 mt-8"},rt=["disabled"],at=["disabled"],lt={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4"},nt={class:"relative bg-gray-900 border border-gray-800 rounded-2xl w-full max-w-3xl max-h-[85vh] flex flex-col shadow-2xl"},it={class:"flex items-start justify-between p-6 border-b border-gray-800"},dt={key:0,class:"h-6 w-48 bg-gray-800 rounded animate-pulse"},ut={key:1,class:"space-y-1 pr-8"},ct={class:"text-xl font-bold text-white leading-tight"},pt={class:"flex items-center gap-2"},gt={class:"text-sm text-emerald-400"},yt={class:"text-sm text-gray-400"},xt={key:0,class:"text-sm text-gray-500"},mt={class:"p-6 overflow-y-auto custom-scrollbar space-y-8"},vt={key:0,class:"space-y-4"},ft={class:"space-y-2"},bt={class:"text-gray-200 whitespace-pre-wrap leading-relaxed"},ht={key:0,class:"space-y-2"},_t={class:"bg-gray-800/50 rounded-xl p-4 text-gray-300 whitespace-pre-wrap leading-relaxed border border-gray-700/50"},wt={key:1,class:"space-y-2"},kt={class:"space-y-2"},Ct={key:2,class:"pt-4 border-t border-gray-800"},$t={class:"flex flex-wrap gap-2"},Dt={class:"p-4 border-t border-gray-800 flex justify-end gap-3 bg-gray-900/50 rounded-b-2xl"},Bt=oe({__name:"QuestionBankDetail",setup(V){const f=le(),b=ne().params.id,p=x(null),C=x([]),$=x(0),D=x(!1),h=x(!1),a=x(null),k=x(!1),u=ie({page:1,page_size:20,bank_id:b,type:void 0,difficulty:void 0}),B={easy:"bg-green-900/30 text-green-400 border-green-800/50",medium:"bg-yellow-900/30 text-yellow-400 border-yellow-800/50",hard:"bg-red-900/30 text-red-400 border-red-800/50"},Q={technical:"技术题",scenario:"场景题",algorithm:"算法题",behavioral:"行为题"};async function ee(){try{const n=await ge(b);p.value=n.data}catch(n){console.error("Failed to load bank info:",n)}}async function _(){D.value=!0;try{const n=await ye(u);C.value=n.data.items,$.value=n.data.total}catch(n){console.error("Failed to fetch questions:",n)}finally{D.value=!1}}function z(){u.page=1,_()}function te(){f.push(`/questions/create?bank_id=${b}`)}async function se(n){h.value=!0,a.value=null,k.value=!0;try{const t=await me(n);a.value=t.data}catch(t){console.error("Failed to fetch question detail:",t),h.value=!1}finally{k.value=!1}}function j(){h.value=!1,a.value=null}function F(n){f.push(`/questions/${n}/edit`)}async function N(n){var t;if(confirm("确定要删除这道题目吗？"))try{await xe(n),_(),h.value&&((t=a.value)==null?void 0:t.id)===n&&j()}catch(M){console.error("Delete failed:",M)}}return re(()=>{ee(),_()}),(n,t)=>{var S,I,L,R,T,U,E,P,A,G,H,J,K,O,W;const M=de("router-link");return o(),s("div",Ce,[e("div",$e,[e("div",De,[e("div",Be,[c(M,{to:"/questions/banks",class:"hover:text-white transition-colors"},{default:ae(()=>[...t[8]||(t[8]=[m("题库管理",-1)])]),_:1}),c(i(we),{class:"w-4 h-4"}),e("span",Qe,l(((S=p.value)==null?void 0:S.name)||"加载中..."),1)]),e("div",je,[e("div",null,[e("h1",Me,[m(l((I=p.value)==null?void 0:I.name)+" ",1),((L=p.value)==null?void 0:L.community_status)==="approved"?(o(),s("span",Ve," 社区题库 ")):d("",!0)]),e("div",ze,[(R=p.value)!=null&&R.creator_username?(o(),s("span",Fe,[c(i(ve),{class:"w-4 h-4"}),m(" "+l(p.value.creator_username),1)])):d("",!0),(T=p.value)!=null&&T.created_at?(o(),s("span",Ne,[c(i(fe),{class:"w-4 h-4"}),m(" "+l(new Date(p.value.created_at).toLocaleDateString()),1)])):d("",!0)]),e("p",Se,l(((U=p.value)==null?void 0:U.description)||"暂无描述"),1),(P=(E=p.value)==null?void 0:E.tags)!=null&&P.length?(o(),s("div",Ie,[(o(!0),s(y,null,v(p.value.tags,r=>(o(),s("span",{key:r,class:"px-2 py-0.5 rounded text-xs bg-dark-800 text-gray-400 border border-white/10"},l(r),1))),128))])):d("",!0)]),e("div",Le,[e("button",{onClick:t[0]||(t[0]=r=>i(f).push(`/questions/banks/${i(b)}/import?bank_id=${i(b)}`)),class:"flex items-center gap-2 px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg font-medium transition-colors border border-gray-700"},[c(i(be),{class:"w-5 h-5"}),t[9]||(t[9]=e("span",null,"导入/批量",-1))]),e("button",{onClick:te,class:"flex items-center gap-2 px-4 py-2 bg-emerald-500 hover:bg-emerald-600 text-white rounded-lg font-medium transition-colors shadow-lg shadow-emerald-500/20"},[c(i(he),{class:"w-5 h-5"}),t[10]||(t[10]=e("span",null,"新建题目",-1))])])])]),e("div",Re,[e("div",Te,[c(i(_e),{class:"w-5 h-5"}),t[11]||(t[11]=e("span",{class:"text-sm font-medium"},"筛选：",-1))]),X(e("select",{"onUpdate:modelValue":t[1]||(t[1]=r=>u.type=r),onChange:z,class:"bg-gray-800 border border-gray-700 rounded-lg px-3 py-1.5 text-sm text-gray-300 focus:outline-none focus:border-emerald-500 focus:ring-1 focus:ring-emerald-500"},[t[12]||(t[12]=e("option",{value:void 0},"全部类型",-1)),(o(),s(y,null,v(Q,(r,g)=>e("option",{key:g,value:g},l(r),9,Ue)),64))],544),[[Y,u.type]]),X(e("select",{"onUpdate:modelValue":t[2]||(t[2]=r=>u.difficulty=r),onChange:z,class:"bg-gray-800 border border-gray-700 rounded-lg px-3 py-1.5 text-sm text-gray-300 focus:outline-none focus:border-emerald-500 focus:ring-1 focus:ring-emerald-500"},[...t[13]||(t[13]=[e("option",{value:void 0},"全部难度",-1),e("option",{value:"easy"},"简单",-1),e("option",{value:"medium"},"中等",-1),e("option",{value:"hard"},"困难",-1)])],544),[[Y,u.difficulty]])]),D.value?(o(),s("div",Ee," 加载中... ")):C.value.length>0?(o(),s("div",Pe,[e("div",Ae,[e("table",Ge,[t[14]||(t[14]=e("thead",null,[e("tr",{class:"border-b border-gray-800 bg-gray-900/50"},[e("th",{class:"px-6 py-4 text-sm font-medium text-gray-400"},"标题"),e("th",{class:"px-6 py-4 text-sm font-medium text-gray-400"},"类型"),e("th",{class:"px-6 py-4 text-sm font-medium text-gray-400"},"难度"),e("th",{class:"px-6 py-4 text-sm font-medium text-gray-400 text-right"},"操作")])],-1)),e("tbody",He,[(o(!0),s(y,null,v(C.value,r=>{var g;return o(),s("tr",{key:r.id,onClick:w=>se(r.id),class:"hover:bg-gray-800/50 cursor-pointer transition-colors"},[e("td",Ke,[e("div",Oe,l(r.title),1),(g=r.tags)!=null&&g.length?(o(),s("div",We,[(o(!0),s(y,null,v(r.tags.slice(0,3),w=>(o(),s("span",{key:w,class:"text-xs text-gray-500 bg-gray-800 px-1.5 py-0.5 rounded"},l(w),1))),128))])):d("",!0)]),e("td",Xe,[e("span",Ye,l(Q[r.type]||r.type),1)]),e("td",Ze,[e("span",{class:ue(["px-2 py-1 rounded text-xs border font-medium",B[r.difficulty]])},l(r.difficulty==="easy"?"简单":r.difficulty==="medium"?"中等":"困难"),3)]),e("td",qe,[e("div",{class:"flex items-center justify-end gap-2",onClick:t[3]||(t[3]=ce(()=>{},["stop"]))},[e("button",{onClick:w=>F(r.id),class:"p-1.5 text-gray-400 hover:text-white hover:bg-gray-700 rounded-lg transition-colors",title:"编辑"},[c(i(Z),{class:"w-4 h-4"})],8,et),e("button",{onClick:w=>N(r.id),class:"p-1.5 text-red-400 hover:text-red-300 hover:bg-red-900/20 rounded-lg transition-colors",title:"删除"},[c(i(q),{class:"w-4 h-4"})],8,tt)])])],8,Je)}),128))])])])])):(o(),s("div",st,[...t[15]||(t[15]=[e("p",null,"该题库暂无题目",-1)])])),$.value>u.page_size?(o(),s("div",ot,[e("button",{disabled:u.page===1,onClick:t[4]||(t[4]=r=>{u.page--,_()}),class:"px-4 py-2 rounded-lg bg-gray-900 border border-gray-800 text-sm hover:bg-gray-800 disabled:opacity-50 disabled:cursor-not-allowed"}," 上一页 ",8,rt),e("button",{disabled:u.page*u.page_size>=$.value,onClick:t[5]||(t[5]=r=>{u.page++,_()}),class:"px-4 py-2 rounded-lg bg-gray-900 border border-gray-800 text-sm hover:bg-gray-800 disabled:opacity-50 disabled:cursor-not-allowed"}," 下一页 ",8,at)])):d("",!0)]),h.value?(o(),s("div",lt,[e("div",{class:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:j}),e("div",nt,[e("div",it,[k.value?(o(),s("div",dt)):(o(),s("div",ut,[e("h2",ct,l((A=a.value)==null?void 0:A.title),1),e("div",pt,[e("span",gt,l(Q[((G=a.value)==null?void 0:G.type)||"technical"]),1),t[16]||(t[16]=e("span",{class:"text-gray-600"},"•",-1)),e("span",yt,l(B[((H=a.value)==null?void 0:H.difficulty)||"medium"].includes("green")?"简单":B[((J=a.value)==null?void 0:J.difficulty)||"medium"].includes("yellow")?"中等":"困难"),1),(K=a.value)!=null&&K.difficulty_score?(o(),s("span",xt,"(难度分: "+l(a.value.difficulty_score)+")",1)):d("",!0)])])),e("button",{onClick:j,class:"p-2 hover:bg-gray-800 rounded-lg text-gray-400 hover:text-white transition-colors absolute right-4 top-4"},[c(i(ke),{class:"w-6 h-6"})])]),e("div",mt,[k.value?(o(),s("div",vt,[...t[17]||(t[17]=[e("div",{class:"h-4 bg-gray-800 rounded w-full animate-pulse"},null,-1),e("div",{class:"h-4 bg-gray-800 rounded w-3/4 animate-pulse"},null,-1),e("div",{class:"h-4 bg-gray-800 rounded w-5/6 animate-pulse"},null,-1)])])):a.value?(o(),s(y,{key:1},[e("div",ft,[t[18]||(t[18]=e("h3",{class:"text-sm font-medium text-gray-400 uppercase tracking-wider"},"题目内容",-1)),e("div",bt,l(a.value.content),1)]),a.value.reference_answer?(o(),s("div",ht,[t[19]||(t[19]=e("h3",{class:"text-sm font-medium text-gray-400 uppercase tracking-wider"},"参考答案",-1)),e("div",_t,l(a.value.reference_answer),1)])):d("",!0),(O=a.value.answer_key_points)!=null&&O.length?(o(),s("div",wt,[t[21]||(t[21]=e("h3",{class:"text-sm font-medium text-gray-400 uppercase tracking-wider"},"得分要点",-1)),e("ul",kt,[(o(!0),s(y,null,v(a.value.answer_key_points,(r,g)=>(o(),s("li",{key:g,class:"flex items-start gap-2 text-gray-300"},[t[20]||(t[20]=e("span",{class:"text-emerald-500 mt-1.5"},"•",-1)),e("span",null,l(r),1)]))),128))])])):d("",!0),(W=a.value.tags)!=null&&W.length?(o(),s("div",Ct,[e("div",$t,[(o(!0),s(y,null,v(a.value.tags,r=>(o(),s("span",{key:r,class:"px-2.5 py-1 rounded-full text-xs bg-gray-800 text-gray-400 border border-gray-700"},l(r),1))),128))])])):d("",!0)],64)):d("",!0)]),e("div",Dt,[a.value?(o(),s("button",{key:0,onClick:t[6]||(t[6]=r=>F(a.value.id)),class:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white rounded-lg text-sm font-medium transition-colors border border-gray-700 flex items-center gap-2"},[c(i(Z),{class:"w-4 h-4"}),t[22]||(t[22]=m(" 编辑 ",-1))])):d("",!0),a.value?(o(),s("button",{key:1,onClick:t[7]||(t[7]=r=>N(a.value.id)),class:"px-4 py-2 bg-red-900/20 hover:bg-red-900/30 text-red-400 rounded-lg text-sm font-medium transition-colors border border-red-900/30 flex items-center gap-2"},[c(i(q),{class:"w-4 h-4"}),t[23]||(t[23]=m(" 删除 ",-1))])):d("",!0)])])])):d("",!0)])}}}),Rt=pe(Bt,[["__scopeId","data-v-9e508ecc"]]);export{Rt as default};
