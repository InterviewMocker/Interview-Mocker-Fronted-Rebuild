import{d as V,l as K,c as l,a as t,i as y,f as U,t as f,x as h,g as b,m as a,y as g,v as x,z as C,F as S,h as D,A as M,u as N,b as T,q as c,s as q,o as n}from"./index-B1_3jWiP.js";import{g as B,u as E,c as F}from"./knowledge-f1rcMVA6.js";import{r as $}from"./ArrowLeftIcon-B7O66r4f.js";const j={class:"min-h-screen bg-gray-950 text-white p-6 lg:p-8"},z={class:"max-w-4xl mx-auto"},R={class:"mb-6 flex items-center gap-4"},A={class:"text-2xl font-bold"},I={key:0,class:"text-center py-20 text-gray-500"},L={class:"bg-gray-900 border border-gray-800 rounded-xl p-6 space-y-6"},O={class:"space-y-2"},G={class:"grid md:grid-cols-3 gap-6"},H={class:"space-y-2"},J={class:"space-y-2"},P={class:"space-y-2"},Q={class:"space-y-2"},W={class:"bg-gray-900 border border-gray-800 rounded-xl p-6 space-y-4"},X={class:"space-y-2"},Y={class:"bg-gray-900 border border-gray-800 rounded-xl p-6 space-y-4"},Z={class:"flex flex-wrap gap-2 mb-2"},ee=["onClick"],te={class:"flex gap-2"},oe=["onKeydown"],se={class:"flex items-center justify-end gap-4 pt-4"},re=["disabled"],ue=V({__name:"KnowledgeEdit",setup(ae){const d=N(),v=T(),p=c(!1),i=c(!1),m=c(!1),o=q({title:"",content:"",summary:"",category:"",doc_type:"",difficulty:"medium",tags:[]}),u=c("");K(async()=>{const r=v.params.id;if(r){p.value=!0,m.value=!0;try{const e=await B(r);Object.assign(o,e.data)}catch(e){console.error("Failed to load document:",e),d.push("/knowledge")}finally{m.value=!1}}});function w(){var e;const r=u.value.trim();r&&!((e=o.tags)!=null&&e.includes(r))&&(o.tags||(o.tags=[]),o.tags.push(r),u.value="")}function k(r){o.tags&&(o.tags=o.tags.filter(e=>e!==r))}async function _(){if(!(!o.title||!o.content)){i.value=!0;try{p.value?await E(v.params.id,o):await F(o),d.push("/knowledge")}catch(r){console.error("Save failed:",r)}finally{i.value=!1}}}return(r,e)=>(n(),l("div",j,[t("div",z,[t("div",R,[t("button",{onClick:e[0]||(e[0]=s=>y(d).back()),class:"p-2 rounded-lg hover:bg-gray-900 text-gray-400 hover:text-white transition-colors"},[U(y($),{class:"w-5 h-5"})]),t("h1",A,f(p.value?"编辑文档":"创建新文档"),1)]),m.value?(n(),l("div",I," 加载中... ")):(n(),l("form",{key:1,onSubmit:h(_,["prevent"]),class:"space-y-6"},[t("div",L,[t("div",O,[e[9]||(e[9]=t("label",{class:"text-sm font-medium text-gray-300"},[b("标题 "),t("span",{class:"text-red-500"},"*")],-1)),a(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>o.title=s),type:"text",required:"",placeholder:"输入文档标题",class:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 transition-colors"},null,512),[[g,o.title]])]),t("div",G,[t("div",H,[e[11]||(e[11]=t("label",{class:"text-sm font-medium text-gray-300"},"分类",-1)),a(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>o.category=s),class:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 transition-colors"},[...e[10]||(e[10]=[C('<option value="">请选择</option><option value="frontend">前端</option><option value="backend">后端</option><option value="algorithm">算法</option><option value="system">系统设计</option>',5)])],512),[[x,o.category]])]),t("div",J,[e[13]||(e[13]=t("label",{class:"text-sm font-medium text-gray-300"},"文档类型",-1)),a(t("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>o.doc_type=s),class:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 transition-colors"},[...e[12]||(e[12]=[t("option",{value:""},"请选择",-1),t("option",{value:"技术文档"},"技术文档",-1),t("option",{value:"面试题解"},"面试题解",-1),t("option",{value:"最佳实践"},"最佳实践",-1)])],512),[[x,o.doc_type]])]),t("div",P,[e[15]||(e[15]=t("label",{class:"text-sm font-medium text-gray-300"},"难度",-1)),a(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>o.difficulty=s),class:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 transition-colors"},[...e[14]||(e[14]=[t("option",{value:"easy"},"简单",-1),t("option",{value:"medium"},"中等",-1),t("option",{value:"hard"},"困难",-1)])],512),[[x,o.difficulty]])])]),t("div",Q,[e[16]||(e[16]=t("label",{class:"text-sm font-medium text-gray-300"},"摘要",-1)),a(t("textarea",{"onUpdate:modelValue":e[5]||(e[5]=s=>o.summary=s),rows:"3",placeholder:"简短的文档描述...",class:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 transition-colors resize-none"},null,512),[[g,o.summary]])])]),t("div",W,[t("div",X,[e[17]||(e[17]=t("label",{class:"text-sm font-medium text-gray-300"},[b("内容 (Markdown) "),t("span",{class:"text-red-500"},"*")],-1)),a(t("textarea",{"onUpdate:modelValue":e[6]||(e[6]=s=>o.content=s),required:"",rows:"20",placeholder:"# 开始编写...",class:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-2.5 text-white font-mono text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 transition-colors"},null,512),[[g,o.content]])])]),t("div",Y,[e[18]||(e[18]=t("label",{class:"text-sm font-medium text-gray-300"},"标签",-1)),t("div",Z,[(n(!0),l(S,null,D(o.tags,s=>(n(),l("span",{key:s,class:"px-3 py-1 bg-emerald-900/30 text-emerald-400 border border-emerald-800/50 rounded-full text-sm flex items-center gap-2"},[b(f(s)+" ",1),t("button",{onClick:le=>k(s),type:"button",class:"hover:text-white"},"×",8,ee)]))),128))]),t("div",te,[a(t("input",{"onUpdate:modelValue":e[7]||(e[7]=s=>u.value=s),onKeydown:M(h(w,["prevent"]),["enter"]),type:"text",placeholder:"添加标签 (按回车)",class:"flex-1 bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-white focus:outline-none focus:ring-2 focus:ring-emerald-500/50 focus:border-emerald-500 transition-colors"},null,40,oe),[[g,u.value]]),t("button",{onClick:w,type:"button",class:"px-4 py-2 bg-gray-800 hover:bg-gray-700 text-white border border-gray-700 rounded-lg transition-colors"}," 添加 ")])]),t("div",se,[t("button",{type:"button",onClick:e[8]||(e[8]=s=>y(d).back()),class:"px-6 py-2.5 bg-gray-800 hover:bg-gray-700 text-white rounded-lg transition-colors border border-gray-700"}," 取消 "),t("button",{type:"submit",disabled:i.value,class:"px-6 py-2.5 bg-emerald-500 hover:bg-emerald-600 text-white rounded-lg font-medium shadow-lg shadow-emerald-500/20 transition-all disabled:opacity-50 disabled:cursor-not-allowed"},f(i.value?"保存中...":"保存文档"),9,re)])],32))])]))}});export{ue as default};
