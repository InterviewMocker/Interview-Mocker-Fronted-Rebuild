# å‰ç«¯è°ƒç”¨è¯´æ˜ä¹¦ - å²—ä½æ¨¡å—

æœ¬æ–‡æ¡£ä¸º Vue3 å‰ç«¯å¼€å‘è€…æä¾›å²—ä½ç®¡ç†åŠŸèƒ½çš„ API è°ƒç”¨æŒ‡å—ã€‚

---

## ç›®å½•

- [1. æ¦‚è¿°](#1-æ¦‚è¿°)
- [2. API æ¥å£è¯´æ˜](#2-api-æ¥å£è¯´æ˜)
- [3. TypeScript ç±»å‹å®šä¹‰](#3-typescript-ç±»å‹å®šä¹‰)
- [4. API å°è£…å®ç°](#4-api-å°è£…å®ç°)
- [5. Vue3 ç»„ä»¶ç¤ºä¾‹](#5-vue3-ç»„ä»¶ç¤ºä¾‹)
- [6. é”™è¯¯å¤„ç†](#6-é”™è¯¯å¤„ç†)

---

## 1. æ¦‚è¿°

### 1.1 æ¨¡å—è¯´æ˜

å²—ä½æ¨¡å—ç”¨äºç®¡ç†é¢è¯•ç›®æ ‡å²—ä½ä¿¡æ¯ï¼ŒåŒ…æ‹¬å²—ä½åç§°ã€æŠ€èƒ½è¦æ±‚ã€å­¦å†è¦æ±‚ã€é¢è¯•æ—¶é•¿ç­‰ã€‚å²—ä½ä¿¡æ¯ä¼šå…³è”åˆ°é¢è¯•ä¼šè¯ã€é¢˜ç›®æ¨èç­‰åŠŸèƒ½ã€‚

### 1.2 API å‰ç¼€

```
/api/v1/positions
```

### 1.3 è®¤è¯è¦æ±‚

| æ¥å£ | è®¤è¯è¦æ±‚ |
|------|---------|
| è·å–å²—ä½åˆ—è¡¨ | âŒ ä¸éœ€è¦ |
| è·å–å²—ä½è¯¦æƒ… | âŒ ä¸éœ€è¦ |
| åˆ›å»ºå²—ä½ | âœ… éœ€è¦ç™»å½• |
| æ›´æ–°å²—ä½ | âœ… éœ€è¦ç™»å½• |
| åˆ é™¤å²—ä½ | âœ… éœ€è¦ç™»å½• |

### 1.4 éš¾åº¦ç­‰çº§æšä¸¾

| å€¼ | è¯´æ˜ |
|-----|------|
| `junior` | åˆçº§ |
| `mid` | ä¸­çº§ |
| `senior` | é«˜çº§ |
| `expert` | ä¸“å®¶ |

### 1.5 å­¦å†è¦æ±‚æšä¸¾

| å€¼ | è¯´æ˜ |
|-----|------|
| `ä¸é™` | ä¸é™å­¦å† |
| `å¤§ä¸“` | å¤§ä¸“åŠä»¥ä¸Š |
| `æœ¬ç§‘` | æœ¬ç§‘åŠä»¥ä¸Š |
| `ç¡•å£«` | ç¡•å£«åŠä»¥ä¸Š |
| `åšå£«` | åšå£«åŠä»¥ä¸Š |

---

## 2. API æ¥å£è¯´æ˜

### 2.1 è·å–å²—ä½åˆ—è¡¨

**GET** `/api/v1/positions`

**æŸ¥è¯¢å‚æ•°ï¼š**

| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| page | int | âŒ | é¡µç ï¼Œé»˜è®¤ 1ï¼Œæœ€å°å€¼ 1 |
| page_size | int | âŒ | æ¯é¡µæ•°é‡ï¼Œé»˜è®¤ 20ï¼ŒèŒƒå›´ 1-100 |
| category | string | âŒ | åˆ†ç±»ç­›é€‰ï¼ˆå¦‚ï¼šæŠ€æœ¯ç±»ã€äº§å“ç±»ã€è¿è¥ç±»ï¼‰ |
| status | string | âŒ | çŠ¶æ€ç­›é€‰ï¼ˆactive/inactive/deletedï¼‰ |

**è¯·æ±‚ç¤ºä¾‹ï¼š**

```
GET /api/v1/positions?page=1&page_size=10&category=æŠ€æœ¯ç±»
```

**æˆåŠŸå“åº”ï¼š**

```json
{
  "code": 200,
  "message": "è·å–æˆåŠŸ",
  "data": {
    "items": [
      {
        "id": "550e8400-e29b-41d4-a716-446655440000",
        "name": "å‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆ",
        "code": "frontend-dev",
        "category": "æŠ€æœ¯ç±»",
        "description": "è´Ÿè´£å…¬å¸äº§å“çš„å‰ç«¯å¼€å‘å·¥ä½œ",
        "required_skills": ["JavaScript", "Vue.js", "React", "TypeScript"],
        "difficulty_level": "mid",
        "education_requirement": "æœ¬ç§‘",
        "default_question_count": 10,
        "default_duration": 30,
        "status": "active",
        "created_by": "admin-user-id",
        "created_at": "2026-02-14T10:00:00Z"
      }
    ],
    "total": 25,
    "page": 1,
    "page_size": 10,
    "total_pages": 3
  }
}
```

---

### 2.2 åˆ›å»ºå²—ä½

**POST** `/api/v1/positions`

**è¯·æ±‚å¤´ï¼š**

```
Authorization: Bearer <access_token>
```

**è¯·æ±‚ä½“ï¼š**

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| name | string | âœ… | å²—ä½åç§°ï¼Œæœ€å¤§ 100 å­—ç¬¦ |
| code | string | âœ… | å²—ä½ç¼–ç ï¼Œæœ€å¤§ 50 å­—ç¬¦ï¼Œå¿…é¡»å”¯ä¸€ |
| category | string | âŒ | åˆ†ç±»ï¼ˆæŠ€æœ¯ç±»/äº§å“ç±»/è¿è¥ç±»/è®¾è®¡ç±»ç­‰ï¼‰ |
| description | string | âŒ | å²—ä½æè¿° |
| requirements | string | âŒ | å²—ä½è¦æ±‚è¯¦æƒ… |
| required_skills | string[] | âŒ | å¿…å¤‡æŠ€èƒ½åˆ—è¡¨ |
| skill_weights | object | âŒ | æŠ€èƒ½æƒé‡é…ç½® |
| difficulty_level | string | âŒ | éš¾åº¦ç­‰çº§ï¼ˆjunior/mid/senior/expertï¼‰ |
| education_requirement | string | âŒ | å­¦å†è¦æ±‚ï¼ˆä¸é™/å¤§ä¸“/æœ¬ç§‘/ç¡•å£«/åšå£«ï¼‰ |
| default_question_count | int | âŒ | é»˜è®¤é¢è¯•é¢˜ç›®æ•°é‡ï¼Œé»˜è®¤ 10 |
| default_duration | int | âŒ | é»˜è®¤é¢è¯•æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰ï¼Œé»˜è®¤ 30 |

**è¯·æ±‚ç¤ºä¾‹ï¼š**

```json
{
  "name": "åç«¯å¼€å‘å·¥ç¨‹å¸ˆ",
  "code": "backend-dev",
  "category": "æŠ€æœ¯ç±»",
  "description": "è´Ÿè´£æœåŠ¡ç«¯æ¥å£å¼€å‘ã€æ•°æ®åº“è®¾è®¡ã€ç³»ç»Ÿæ¶æ„ä¼˜åŒ–",
  "requirements": "1. ç†Ÿæ‚‰ Python/Java/Go è‡³å°‘ä¸€é—¨åç«¯è¯­è¨€\n2. ç†Ÿæ‚‰ MySQLã€Redis ç­‰æ•°æ®åº“\n3. äº†è§£åˆ†å¸ƒå¼ç³»ç»Ÿè®¾è®¡",
  "required_skills": ["Python", "MySQL", "Redis", "Docker", "Linux"],
  "skill_weights": {
    "Python": 0.3,
    "MySQL": 0.25,
    "Redis": 0.15,
    "Docker": 0.15,
    "Linux": 0.15
  },
  "difficulty_level": "mid",
  "education_requirement": "æœ¬ç§‘",
  "default_question_count": 12,
  "default_duration": 45
}
```

**æˆåŠŸå“åº”ï¼š**

```json
{
  "code": 200,
  "message": "åˆ›å»ºæˆåŠŸ",
  "data": {
    "id": "550e8400-e29b-41d4-a716-446655440001",
    "name": "åç«¯å¼€å‘å·¥ç¨‹å¸ˆ",
    "code": "backend-dev",
    "category": "æŠ€æœ¯ç±»",
    "description": "è´Ÿè´£æœåŠ¡ç«¯æ¥å£å¼€å‘ã€æ•°æ®åº“è®¾è®¡ã€ç³»ç»Ÿæ¶æ„ä¼˜åŒ–",
    "required_skills": ["Python", "MySQL", "Redis", "Docker", "Linux"],
    "difficulty_level": "mid",
    "education_requirement": "æœ¬ç§‘",
    "default_question_count": 12,
    "default_duration": 45,
    "status": "active",
    "created_by": "current-user-id",
    "created_at": "2026-02-14T15:00:00Z"
  }
}
```

**é”™è¯¯å“åº”ï¼š**

| HTTP çŠ¶æ€ç  | é”™è¯¯ä¿¡æ¯ |
|------------|---------|
| 400 | å²—ä½ç¼–ç å·²å­˜åœ¨ |
| 422 | å‚æ•°éªŒè¯å¤±è´¥ |

---

### 2.3 è·å–å²—ä½è¯¦æƒ…

**GET** `/api/v1/positions/{position_id}`

**è·¯å¾„å‚æ•°ï¼š**

| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| position_id | string | å²—ä½ UUID |

**æˆåŠŸå“åº”ï¼š**

```json
{
  "code": 200,
  "message": "è·å–æˆåŠŸ",
  "data": {
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "name": "å‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆ",
    "code": "frontend-dev",
    "category": "æŠ€æœ¯ç±»",
    "description": "è´Ÿè´£å…¬å¸äº§å“çš„å‰ç«¯å¼€å‘å·¥ä½œ",
    "required_skills": ["JavaScript", "Vue.js", "React", "TypeScript"],
    "difficulty_level": "mid",
    "education_requirement": "æœ¬ç§‘",
    "default_question_count": 10,
    "default_duration": 30,
    "status": "active",
    "created_by": "admin-user-id",
    "created_at": "2026-02-14T10:00:00Z"
  }
}
```

**é”™è¯¯å“åº”ï¼š**

| HTTP çŠ¶æ€ç  | é”™è¯¯ä¿¡æ¯ |
|------------|---------|
| 404 | å²—ä½ä¸å­˜åœ¨ |

---

### 2.4 æ›´æ–°å²—ä½

**PUT** `/api/v1/positions/{position_id}`

**è¯·æ±‚å¤´ï¼š**

```
Authorization: Bearer <access_token>
```

**è¯·æ±‚ä½“ï¼š**

| å­—æ®µ | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| name | string | âŒ | å²—ä½åç§° |
| category | string | âŒ | åˆ†ç±» |
| description | string | âŒ | å²—ä½æè¿° |
| requirements | string | âŒ | å²—ä½è¦æ±‚ |
| required_skills | string[] | âŒ | å¿…å¤‡æŠ€èƒ½ |
| skill_weights | object | âŒ | æŠ€èƒ½æƒé‡ |
| difficulty_level | string | âŒ | éš¾åº¦ç­‰çº§ |
| education_requirement | string | âŒ | å­¦å†è¦æ±‚ |
| default_question_count | int | âŒ | é»˜è®¤é¢˜ç›®æ•°é‡ |
| default_duration | int | âŒ | é»˜è®¤é¢è¯•æ—¶é•¿ |
| status | string | âŒ | çŠ¶æ€ï¼ˆactive/inactiveï¼‰ |

**è¯·æ±‚ç¤ºä¾‹ï¼š**

```json
{
  "name": "é«˜çº§å‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆ",
  "difficulty_level": "senior",
  "default_question_count": 15,
  "default_duration": 45
}
```

**æˆåŠŸå“åº”ï¼š**

```json
{
  "code": 200,
  "message": "æ›´æ–°æˆåŠŸ",
  "data": {
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "name": "é«˜çº§å‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆ",
    "code": "frontend-dev",
    "category": "æŠ€æœ¯ç±»",
    "description": "è´Ÿè´£å…¬å¸äº§å“çš„å‰ç«¯å¼€å‘å·¥ä½œ",
    "required_skills": ["JavaScript", "Vue.js", "React", "TypeScript"],
    "difficulty_level": "senior",
    "education_requirement": "æœ¬ç§‘",
    "default_question_count": 15,
    "default_duration": 45,
    "status": "active",
    "created_by": "admin-user-id",
    "created_at": "2026-02-14T10:00:00Z"
  }
}
```

**é”™è¯¯å“åº”ï¼š**

| HTTP çŠ¶æ€ç  | é”™è¯¯ä¿¡æ¯ |
|------------|---------|
| 404 | å²—ä½ä¸å­˜åœ¨ |

---

### 2.5 åˆ é™¤å²—ä½

**DELETE** `/api/v1/positions/{position_id}`

**è¯·æ±‚å¤´ï¼š**

```
Authorization: Bearer <access_token>
```

**æˆåŠŸå“åº”ï¼š**

```json
{
  "code": 200,
  "message": "åˆ é™¤æˆåŠŸ",
  "data": null
}
```

**é”™è¯¯å“åº”ï¼š**

| HTTP çŠ¶æ€ç  | é”™è¯¯ä¿¡æ¯ |
|------------|---------|
| 404 | å²—ä½ä¸å­˜åœ¨ |

---

## 3. TypeScript ç±»å‹å®šä¹‰

åˆ›å»º `src/types/position.ts`ï¼š

```typescript
// ============ æšä¸¾ç±»å‹ ============

/** éš¾åº¦ç­‰çº§ */
export type DifficultyLevel = 'junior' | 'mid' | 'senior' | 'expert'

/** å­¦å†è¦æ±‚ */
export type EducationRequirement = 'ä¸é™' | 'å¤§ä¸“' | 'æœ¬ç§‘' | 'ç¡•å£«' | 'åšå£«'

// ============ è¯·æ±‚ç±»å‹ ============

/** åˆ›å»ºå²—ä½è¯·æ±‚ */
export interface PositionCreate {
  name: string
  code: string
  category?: string
  description?: string
  requirements?: string
  required_skills?: string[]
  skill_weights?: Record<string, number>
  difficulty_level?: DifficultyLevel
  education_requirement?: EducationRequirement
  default_question_count?: number
  default_duration?: number
}

/** æ›´æ–°å²—ä½è¯·æ±‚ */
export interface PositionUpdate {
  name?: string
  category?: string
  description?: string
  requirements?: string
  required_skills?: string[]
  skill_weights?: Record<string, number>
  difficulty_level?: DifficultyLevel
  education_requirement?: EducationRequirement
  default_question_count?: number
  default_duration?: number
  status?: 'active' | 'inactive'
}

/** å²—ä½åˆ—è¡¨æŸ¥è¯¢å‚æ•° */
export interface PositionListParams {
  page?: number
  page_size?: number
  category?: string
  status?: string
}

// ============ å“åº”ç±»å‹ ============

/** å²—ä½å“åº” */
export interface Position {
  id: string
  name: string
  code: string
  category: string | null
  description: string | null
  required_skills: string[] | null
  difficulty_level: DifficultyLevel | null
  education_requirement: EducationRequirement | null
  default_question_count: number
  default_duration: number
  status: string
  created_by: string | null
  created_at: string
}

/** åˆ†é¡µå“åº” */
export interface PaginatedResponse<T> {
  items: T[]
  total: number
  page: number
  page_size: number
  total_pages: number
}

/** ç»Ÿä¸€ API å“åº”æ ¼å¼ */
export interface ApiResponse<T = any> {
  code: number
  message: string
  data: T
}
```

---

## 4. API å°è£…å®ç°

åˆ›å»º `src/api/position.ts`ï¼š

```typescript
import request from '@/utils/request'
import type {
  PositionCreate,
  PositionUpdate,
  PositionListParams,
  Position,
  PaginatedResponse,
  ApiResponse
} from '@/types/position'

const POSITION_PREFIX = '/positions'

/** è·å–å²—ä½åˆ—è¡¨ */
export function listPositions(
  params?: PositionListParams
): Promise<ApiResponse<PaginatedResponse<Position>>> {
  return request.get(POSITION_PREFIX, { params })
}

/** åˆ›å»ºå²—ä½ */
export function createPosition(
  data: PositionCreate
): Promise<ApiResponse<Position>> {
  return request.post(POSITION_PREFIX, data)
}

/** è·å–å²—ä½è¯¦æƒ… */
export function getPosition(
  positionId: string
): Promise<ApiResponse<Position>> {
  return request.get(`${POSITION_PREFIX}/${positionId}`)
}

/** æ›´æ–°å²—ä½ */
export function updatePosition(
  positionId: string,
  data: PositionUpdate
): Promise<ApiResponse<Position>> {
  return request.put(`${POSITION_PREFIX}/${positionId}`, data)
}

/** åˆ é™¤å²—ä½ */
export function deletePosition(
  positionId: string
): Promise<ApiResponse<null>> {
  return request.delete(`${POSITION_PREFIX}/${positionId}`)
}
```

---

## 5. Vue3 ç»„ä»¶ç¤ºä¾‹

### 5.1 å²—ä½åˆ—è¡¨ç»„ä»¶

åˆ›å»º `src/views/position/PositionListView.vue`ï¼š

```vue
<script setup lang="ts">
import { ref, onMounted } from 'vue'
import { useRouter } from 'vue-router'
import { listPositions, deletePosition } from '@/api/position'
import type { Position, PositionListParams } from '@/types/position'

const router = useRouter()

const positions = ref<Position[]>([])
const loading = ref(false)
const total = ref(0)

const queryParams = ref<PositionListParams>({
  page: 1,
  page_size: 12,
  category: undefined
})

// éš¾åº¦ç­‰çº§æ˜¾ç¤ºåç§°
const difficultyNames: Record<string, string> = {
  junior: 'åˆçº§',
  mid: 'ä¸­çº§',
  senior: 'é«˜çº§',
  expert: 'ä¸“å®¶'
}

// éš¾åº¦ç­‰çº§é¢œè‰²
const difficultyColors: Record<string, string> = {
  junior: '#4caf50',
  mid: '#2196f3',
  senior: '#ff9800',
  expert: '#f44336'
}

async function fetchPositions() {
  loading.value = true
  try {
    const res = await listPositions(queryParams.value)
    positions.value = res.data.items
    total.value = res.data.total
  } catch (error) {
    console.error('è·å–å²—ä½åˆ—è¡¨å¤±è´¥:', error)
  } finally {
    loading.value = false
  }
}

function viewPosition(id: string) {
  router.push(`/positions/${id}`)
}

function editPosition(id: string) {
  router.push(`/positions/${id}/edit`)
}

function startInterview(id: string) {
  router.push(`/interview/start?position_id=${id}`)
}

async function handleDelete(id: string) {
  if (!confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå²—ä½å—ï¼Ÿ')) return
  
  try {
    await deletePosition(id)
    fetchPositions()
  } catch (error) {
    console.error('åˆ é™¤å¤±è´¥:', error)
  }
}

function handleFilterChange() {
  queryParams.value.page = 1
  fetchPositions()
}

function handlePageChange(page: number) {
  queryParams.value.page = page
  fetchPositions()
}

onMounted(() => {
  fetchPositions()
})
</script>

<template>
  <div class="position-list">
    <div class="header">
      <h1>å²—ä½ç®¡ç†</h1>
      <router-link to="/positions/create" class="btn-create">
        æ–°å»ºå²—ä½
      </router-link>
    </div>

    <div class="filters">
      <select v-model="queryParams.category" @change="handleFilterChange">
        <option :value="undefined">å…¨éƒ¨åˆ†ç±»</option>
        <option value="æŠ€æœ¯ç±»">æŠ€æœ¯ç±»</option>
        <option value="äº§å“ç±»">äº§å“ç±»</option>
        <option value="è¿è¥ç±»">è¿è¥ç±»</option>
        <option value="è®¾è®¡ç±»">è®¾è®¡ç±»</option>
        <option value="å¸‚åœºç±»">å¸‚åœºç±»</option>
      </select>

      <select v-model="queryParams.status" @change="handleFilterChange">
        <option :value="undefined">å…¨éƒ¨çŠ¶æ€</option>
        <option value="active">å¯ç”¨</option>
        <option value="inactive">åœç”¨</option>
      </select>
    </div>

    <div v-if="loading" class="loading">åŠ è½½ä¸­...</div>

    <div v-else class="position-grid">
      <div 
        v-for="position in positions" 
        :key="position.id" 
        class="position-card"
      >
        <div class="card-header">
          <h3 @click="viewPosition(position.id)">{{ position.name }}</h3>
          <span 
            v-if="position.difficulty_level"
            class="difficulty-badge"
            :style="{ backgroundColor: difficultyColors[position.difficulty_level] }"
          >
            {{ difficultyNames[position.difficulty_level] }}
          </span>
        </div>

        <p class="code">ç¼–ç ï¼š{{ position.code }}</p>
        <p class="description">{{ position.description || 'æš‚æ— æè¿°' }}</p>

        <div class="meta">
          <span v-if="position.category" class="tag category">
            {{ position.category }}
          </span>
          <span v-if="position.education_requirement" class="tag education">
            {{ position.education_requirement }}
          </span>
        </div>

        <div class="skills" v-if="position.required_skills?.length">
          <span v-for="skill in position.required_skills.slice(0, 5)" :key="skill" class="skill">
            {{ skill }}
          </span>
          <span v-if="position.required_skills.length > 5" class="skill more">
            +{{ position.required_skills.length - 5 }}
          </span>
        </div>

        <div class="interview-info">
          <span>ğŸ“ {{ position.default_question_count }} é¢˜</span>
          <span>â±ï¸ {{ position.default_duration }} åˆ†é’Ÿ</span>
        </div>

        <div class="actions">
          <button @click="startInterview(position.id)" class="primary">
            å¼€å§‹é¢è¯•
          </button>
          <button @click="editPosition(position.id)">ç¼–è¾‘</button>
          <button @click="handleDelete(position.id)" class="danger">åˆ é™¤</button>
        </div>
      </div>
    </div>

    <div class="pagination" v-if="total > queryParams.page_size!">
      <button 
        :disabled="queryParams.page === 1"
        @click="handlePageChange(queryParams.page! - 1)"
      >
        ä¸Šä¸€é¡µ
      </button>
      <span>{{ queryParams.page }} / {{ Math.ceil(total / queryParams.page_size!) }}</span>
      <button 
        :disabled="queryParams.page! * queryParams.page_size! >= total"
        @click="handlePageChange(queryParams.page! + 1)"
      >
        ä¸‹ä¸€é¡µ
      </button>
    </div>
  </div>
</template>

<style scoped>
.position-list {
  padding: 20px;
  max-width: 1200px;
  margin: 0 auto;
}

.header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.btn-create {
  background: #667eea;
  color: white;
  padding: 10px 20px;
  border-radius: 8px;
  text-decoration: none;
}

.filters {
  display: flex;
  gap: 12px;
  margin-bottom: 20px;
}

.filters select {
  padding: 8px 12px;
  border: 1px solid #ddd;
  border-radius: 6px;
}

.position-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
  gap: 20px;
}

.position-card {
  background: white;
  border: 1px solid #eee;
  border-radius: 12px;
  padding: 20px;
  transition: box-shadow 0.2s;
}

.position-card:hover {
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.card-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
}

.card-header h3 {
  margin: 0;
  cursor: pointer;
  color: #333;
}

.card-header h3:hover {
  color: #667eea;
}

.difficulty-badge {
  font-size: 12px;
  padding: 4px 8px;
  color: white;
  border-radius: 4px;
}

.code {
  font-size: 12px;
  color: #888;
  margin: 0 0 8px 0;
}

.description {
  color: #666;
  font-size: 14px;
  margin-bottom: 12px;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.meta {
  display: flex;
  gap: 8px;
  margin-bottom: 12px;
}

.tag {
  font-size: 12px;
  padding: 2px 8px;
  background: #f0f0f0;
  border-radius: 4px;
}

.tag.category {
  background: #e3f2fd;
  color: #1976d2;
}

.tag.education {
  background: #fce4ec;
  color: #c2185b;
}

.skills {
  display: flex;
  gap: 6px;
  flex-wrap: wrap;
  margin-bottom: 12px;
}

.skill {
  font-size: 11px;
  padding: 2px 6px;
  background: #f5f5f5;
  border-radius: 3px;
  color: #666;
}

.skill.more {
  background: #e0e0e0;
}

.interview-info {
  display: flex;
  gap: 16px;
  font-size: 13px;
  color: #666;
  margin-bottom: 16px;
  padding: 8px 0;
  border-top: 1px solid #f0f0f0;
}

.actions {
  display: flex;
  gap: 8px;
}

.actions button {
  flex: 1;
  padding: 8px 12px;
  border: 1px solid #ddd;
  border-radius: 6px;
  background: white;
  cursor: pointer;
  font-size: 13px;
}

.actions button.primary {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  border: none;
}

.actions button.danger {
  color: #e74c3c;
  border-color: #e74c3c;
}

.pagination {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 20px;
  margin-top: 30px;
}

.pagination button {
  padding: 8px 16px;
  border: 1px solid #ddd;
  border-radius: 6px;
  background: white;
  cursor: pointer;
}

.pagination button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.loading {
  text-align: center;
  padding: 40px;
  color: #666;
}
</style>
```

### 5.2 åˆ›å»º/ç¼–è¾‘å²—ä½ç»„ä»¶

åˆ›å»º `src/views/position/PositionEditView.vue`ï¼š

```vue
<script setup lang="ts">
import { ref, onMounted, computed } from 'vue'
import { useRouter, useRoute } from 'vue-router'
import { createPosition, getPosition, updatePosition } from '@/api/position'
import type { PositionCreate, PositionUpdate } from '@/types/position'

const router = useRouter()
const route = useRoute()

const isEdit = computed(() => !!route.params.id)
const positionId = computed(() => route.params.id as string)

const loading = ref(false)
const saving = ref(false)

const form = ref<PositionCreate>({
  name: '',
  code: '',
  category: '',
  description: '',
  requirements: '',
  required_skills: [],
  skill_weights: {},
  difficulty_level: undefined,
  education_requirement: undefined,
  default_question_count: 10,
  default_duration: 30
})

const skillInput = ref('')

// åŠ è½½å²—ä½æ•°æ®
async function loadPosition() {
  if (!isEdit.value) return
  
  loading.value = true
  try {
    const res = await getPosition(positionId.value)
    const pos = res.data
    form.value = {
      name: pos.name,
      code: pos.code,
      category: pos.category || '',
      description: pos.description || '',
      requirements: '',
      required_skills: pos.required_skills || [],
      skill_weights: {},
      difficulty_level: pos.difficulty_level || undefined,
      education_requirement: pos.education_requirement || undefined,
      default_question_count: pos.default_question_count,
      default_duration: pos.default_duration
    }
  } catch (error) {
    console.error('åŠ è½½å²—ä½å¤±è´¥:', error)
    router.push('/positions')
  } finally {
    loading.value = false
  }
}

// æ·»åŠ æŠ€èƒ½
function addSkill() {
  const skill = skillInput.value.trim()
  if (skill && !form.value.required_skills?.includes(skill)) {
    form.value.required_skills = [...(form.value.required_skills || []), skill]
    skillInput.value = ''
  }
}

// ç§»é™¤æŠ€èƒ½
function removeSkill(skill: string) {
  form.value.required_skills = form.value.required_skills?.filter(s => s !== skill)
}

// ç”Ÿæˆå²—ä½ç¼–ç 
function generateCode() {
  if (form.value.name && !form.value.code) {
    // ç®€å•çš„æ‹¼éŸ³é¦–å­—æ¯æå–ï¼ˆå®é™…é¡¹ç›®å¯ä½¿ç”¨æ‹¼éŸ³åº“ï¼‰
    form.value.code = form.value.name
      .toLowerCase()
      .replace(/[\u4e00-\u9fa5]/g, '')
      .replace(/\s+/g, '-')
      .substring(0, 20) || 'position-' + Date.now()
  }
}

// æäº¤è¡¨å•
async function handleSubmit() {
  if (!form.value.name || !form.value.code) {
    alert('è¯·å¡«å†™å²—ä½åç§°å’Œç¼–ç ')
    return
  }

  saving.value = true
  try {
    if (isEdit.value) {
      const updateData: PositionUpdate = { ...form.value }
      delete (updateData as any).code // ç¼–ç ä¸å¯ä¿®æ”¹
      await updatePosition(positionId.value, updateData)
    } else {
      await createPosition(form.value)
    }
    router.push('/positions')
  } catch (error: any) {
    const message = error.response?.data?.message || 'ä¿å­˜å¤±è´¥'
    alert(message)
  } finally {
    saving.value = false
  }
}

onMounted(() => {
  loadPosition()
})
</script>

<template>
  <div class="position-edit">
    <h1>{{ isEdit ? 'ç¼–è¾‘å²—ä½' : 'æ–°å»ºå²—ä½' }}</h1>

    <div v-if="loading" class="loading">åŠ è½½ä¸­...</div>

    <form v-else @submit.prevent="handleSubmit" class="edit-form">
      <div class="form-section">
        <h2>åŸºæœ¬ä¿¡æ¯</h2>
        
        <div class="form-row">
          <div class="form-group">
            <label for="name">å²—ä½åç§° *</label>
            <input
              id="name"
              v-model="form.name"
              type="text"
              placeholder="å¦‚ï¼šå‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆ"
              maxlength="100"
              required
              @blur="generateCode"
            />
          </div>

          <div class="form-group">
            <label for="code">å²—ä½ç¼–ç  * {{ isEdit ? '(ä¸å¯ä¿®æ”¹)' : '' }}</label>
            <input
              id="code"
              v-model="form.code"
              type="text"
              placeholder="å¦‚ï¼šfrontend-dev"
              maxlength="50"
              required
              :disabled="isEdit"
            />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="category">åˆ†ç±»</label>
            <select id="category" v-model="form.category">
              <option value="">è¯·é€‰æ‹©</option>
              <option value="æŠ€æœ¯ç±»">æŠ€æœ¯ç±»</option>
              <option value="äº§å“ç±»">äº§å“ç±»</option>
              <option value="è¿è¥ç±»">è¿è¥ç±»</option>
              <option value="è®¾è®¡ç±»">è®¾è®¡ç±»</option>
              <option value="å¸‚åœºç±»">å¸‚åœºç±»</option>
            </select>
          </div>

          <div class="form-group">
            <label for="difficulty">éš¾åº¦ç­‰çº§</label>
            <select id="difficulty" v-model="form.difficulty_level">
              <option :value="undefined">è¯·é€‰æ‹©</option>
              <option value="junior">åˆçº§</option>
              <option value="mid">ä¸­çº§</option>
              <option value="senior">é«˜çº§</option>
              <option value="expert">ä¸“å®¶</option>
            </select>
          </div>

          <div class="form-group">
            <label for="education">å­¦å†è¦æ±‚</label>
            <select id="education" v-model="form.education_requirement">
              <option :value="undefined">è¯·é€‰æ‹©</option>
              <option value="ä¸é™">ä¸é™</option>
              <option value="å¤§ä¸“">å¤§ä¸“</option>
              <option value="æœ¬ç§‘">æœ¬ç§‘</option>
              <option value="ç¡•å£«">ç¡•å£«</option>
              <option value="åšå£«">åšå£«</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label for="description">å²—ä½æè¿°</label>
          <textarea
            id="description"
            v-model="form.description"
            placeholder="è¯·è¾“å…¥å²—ä½æè¿°"
            rows="3"
          ></textarea>
        </div>

        <div class="form-group">
          <label for="requirements">å²—ä½è¦æ±‚</label>
          <textarea
            id="requirements"
            v-model="form.requirements"
            placeholder="è¯·è¾“å…¥è¯¦ç»†çš„å²—ä½è¦æ±‚"
            rows="4"
          ></textarea>
        </div>
      </div>

      <div class="form-section">
        <h2>æŠ€èƒ½è¦æ±‚</h2>

        <div class="form-group">
          <label>å¿…å¤‡æŠ€èƒ½</label>
          <div class="skill-input">
            <input
              v-model="skillInput"
              type="text"
              placeholder="è¾“å…¥æŠ€èƒ½åç§°åæŒ‰å›è½¦"
              @keydown.enter.prevent="addSkill"
            />
            <button type="button" @click="addSkill">æ·»åŠ </button>
          </div>
          <div class="skills" v-if="form.required_skills?.length">
            <span v-for="skill in form.required_skills" :key="skill" class="skill">
              {{ skill }}
              <button type="button" @click="removeSkill(skill)">Ã—</button>
            </span>
          </div>
        </div>
      </div>

      <div class="form-section">
        <h2>é¢è¯•é…ç½®</h2>

        <div class="form-row">
          <div class="form-group">
            <label for="question_count">é»˜è®¤é¢˜ç›®æ•°é‡</label>
            <input
              id="question_count"
              v-model.number="form.default_question_count"
              type="number"
              min="1"
              max="50"
            />
          </div>

          <div class="form-group">
            <label for="duration">é»˜è®¤é¢è¯•æ—¶é•¿ï¼ˆåˆ†é’Ÿï¼‰</label>
            <input
              id="duration"
              v-model.number="form.default_duration"
              type="number"
              min="5"
              max="180"
            />
          </div>
        </div>
      </div>

      <div class="form-actions">
        <button type="button" @click="router.back()" class="btn-cancel">
          å–æ¶ˆ
        </button>
        <button type="submit" :disabled="saving" class="btn-submit">
          {{ saving ? 'ä¿å­˜ä¸­...' : 'ä¿å­˜' }}
        </button>
      </div>
    </form>
  </div>
</template>

<style scoped>
.position-edit {
  padding: 20px;
  max-width: 800px;
  margin: 0 auto;
}

.edit-form {
  background: white;
  border-radius: 12px;
  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
}

.form-section {
  padding: 24px;
  border-bottom: 1px solid #f0f0f0;
}

.form-section:last-of-type {
  border-bottom: none;
}

.form-section h2 {
  margin: 0 0 20px 0;
  font-size: 16px;
  color: #333;
}

.form-group {
  margin-bottom: 16px;
}

.form-group label {
  display: block;
  margin-bottom: 8px;
  font-weight: 500;
  color: #555;
}

.form-group input,
.form-group select,
.form-group textarea {
  width: 100%;
  padding: 10px 14px;
  border: 1px solid #ddd;
  border-radius: 8px;
  font-size: 14px;
}

.form-group input:disabled {
  background: #f5f5f5;
  cursor: not-allowed;
}

.form-group textarea {
  resize: vertical;
}

.form-row {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 16px;
}

.skill-input {
  display: flex;
  gap: 8px;
}

.skill-input input {
  flex: 1;
}

.skill-input button {
  padding: 10px 16px;
  background: #667eea;
  color: white;
  border: none;
  border-radius: 8px;
  cursor: pointer;
}

.skills {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
  margin-top: 12px;
}

.skill {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 6px 12px;
  background: #e3f2fd;
  color: #1976d2;
  border-radius: 6px;
  font-size: 14px;
}

.skill button {
  background: none;
  border: none;
  color: #1976d2;
  cursor: pointer;
  padding: 0;
  font-size: 18px;
  line-height: 1;
}

.form-actions {
  display: flex;
  justify-content: flex-end;
  gap: 12px;
  padding: 24px;
  background: #f8f9fa;
  border-radius: 0 0 12px 12px;
}

.btn-cancel {
  padding: 12px 24px;
  border: 1px solid #ddd;
  border-radius: 8px;
  background: white;
  cursor: pointer;
}

.btn-submit {
  padding: 12px 24px;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  border: none;
  border-radius: 8px;
  cursor: pointer;
}

.btn-submit:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

.loading {
  text-align: center;
  padding: 40px;
  color: #666;
}
</style>
```

### 5.3 å²—ä½é€‰æ‹©å™¨ç»„ä»¶

åˆ›å»º `src/components/PositionSelector.vue`ï¼š

```vue
<script setup lang="ts">
import { ref, onMounted, watch } from 'vue'
import { listPositions } from '@/api/position'
import type { Position } from '@/types/position'

interface Props {
  modelValue?: string
  placeholder?: string
  disabled?: boolean
}

interface Emits {
  (e: 'update:modelValue', value: string): void
  (e: 'change', position: Position | null): void
}

const props = withDefaults(defineProps<Props>(), {
  placeholder: 'è¯·é€‰æ‹©å²—ä½',
  disabled: false
})

const emit = defineEmits<Emits>()

const positions = ref<Position[]>([])
const loading = ref(false)

async function fetchPositions() {
  loading.value = true
  try {
    const res = await listPositions({ page_size: 100, status: 'active' })
    positions.value = res.data.items
  } catch (error) {
    console.error('è·å–å²—ä½åˆ—è¡¨å¤±è´¥:', error)
  } finally {
    loading.value = false
  }
}

function handleChange(event: Event) {
  const value = (event.target as HTMLSelectElement).value
  emit('update:modelValue', value)
  
  const selected = positions.value.find(p => p.id === value) || null
  emit('change', selected)
}

onMounted(() => {
  fetchPositions()
})
</script>

<template>
  <select 
    :value="modelValue" 
    @change="handleChange"
    :disabled="disabled || loading"
    class="position-selector"
  >
    <option value="">{{ loading ? 'åŠ è½½ä¸­...' : placeholder }}</option>
    <option v-for="pos in positions" :key="pos.id" :value="pos.id">
      {{ pos.name }}
      <template v-if="pos.difficulty_level">
        ({{ pos.difficulty_level }})
      </template>
    </option>
  </select>
</template>

<style scoped>
.position-selector {
  width: 100%;
  padding: 10px 14px;
  border: 1px solid #ddd;
  border-radius: 8px;
  font-size: 14px;
  background: white;
}

.position-selector:disabled {
  background: #f5f5f5;
  cursor: not-allowed;
}
</style>
```

**ä½¿ç”¨ç¤ºä¾‹ï¼š**

```vue
<template>
  <PositionSelector 
    v-model="selectedPositionId" 
    @change="handlePositionChange"
    placeholder="è¯·é€‰æ‹©é¢è¯•å²—ä½"
  />
</template>

<script setup lang="ts">
import { ref } from 'vue'
import PositionSelector from '@/components/PositionSelector.vue'
import type { Position } from '@/types/position'

const selectedPositionId = ref('')

function handlePositionChange(position: Position | null) {
  if (position) {
    console.log('é€‰æ‹©çš„å²—ä½:', position.name)
    console.log('é»˜è®¤é¢˜ç›®æ•°:', position.default_question_count)
    console.log('é»˜è®¤æ—¶é•¿:', position.default_duration)
  }
}
</script>
```

---

## 6. é”™è¯¯å¤„ç†

### 6.1 é”™è¯¯ç å¯¹ç…§è¡¨

| HTTP çŠ¶æ€ç  | ä¸šåŠ¡å«ä¹‰ | å‰ç«¯å¤„ç†å»ºè®® |
|------------|---------|-------------|
| 200 | è¯·æ±‚æˆåŠŸ | æ­£å¸¸å¤„ç†å“åº”æ•°æ® |
| 400 | å²—ä½ç¼–ç å·²å­˜åœ¨ | æ˜¾ç¤ºé”™è¯¯æç¤ºï¼Œå»ºè®®ä¿®æ”¹ç¼–ç  |
| 401 | æœªè®¤è¯ / Token è¿‡æœŸ | è·³è½¬ç™»å½•é¡µ |
| 404 | å²—ä½ä¸å­˜åœ¨ | æ˜¾ç¤º 404 æˆ–è¿”å›åˆ—è¡¨ |
| 422 | å‚æ•°éªŒè¯å¤±è´¥ | æ˜¾ç¤ºå…·ä½“éªŒè¯é”™è¯¯ |

### 6.2 ç»„åˆå¼å‡½æ•°å°è£…

åˆ›å»º `src/composables/usePosition.ts`ï¼š

```typescript
import { ref, reactive } from 'vue'
import {
  listPositions,
  createPosition,
  getPosition,
  updatePosition,
  deletePosition
} from '@/api/position'
import type {
  Position,
  PositionCreate,
  PositionUpdate,
  PositionListParams
} from '@/types/position'

// å²—ä½åˆ—è¡¨ Hook
export function usePositionList() {
  const positions = ref<Position[]>([])
  const total = ref(0)
  const loading = ref(false)
  const error = ref<string | null>(null)

  const params = reactive<PositionListParams>({
    page: 1,
    page_size: 20
  })

  async function fetch() {
    loading.value = true
    error.value = null
    try {
      const res = await listPositions(params)
      positions.value = res.data.items
      total.value = res.data.total
    } catch (e: any) {
      error.value = e.response?.data?.message || 'è·å–å¤±è´¥'
    } finally {
      loading.value = false
    }
  }

  async function remove(id: string): Promise<boolean> {
    try {
      await deletePosition(id)
      await fetch()
      return true
    } catch {
      return false
    }
  }

  return { positions, total, loading, error, params, fetch, remove }
}

// å²—ä½è¯¦æƒ… Hook
export function usePositionDetail() {
  const position = ref<Position | null>(null)
  const loading = ref(false)
  const error = ref<string | null>(null)

  async function fetch(id: string) {
    loading.value = true
    error.value = null
    try {
      const res = await getPosition(id)
      position.value = res.data
    } catch (e: any) {
      error.value = e.response?.data?.message || 'è·å–å¤±è´¥'
    } finally {
      loading.value = false
    }
  }

  async function save(data: PositionCreate | PositionUpdate, id?: string): Promise<boolean> {
    loading.value = true
    try {
      if (id) {
        await updatePosition(id, data as PositionUpdate)
      } else {
        await createPosition(data as PositionCreate)
      }
      return true
    } catch (e: any) {
      error.value = e.response?.data?.message || 'ä¿å­˜å¤±è´¥'
      return false
    } finally {
      loading.value = false
    }
  }

  return { position, loading, error, fetch, save }
}

// å²—ä½é€‰æ‹© Hook
export function usePositionSelect() {
  const positions = ref<Position[]>([])
  const loading = ref(false)

  async function fetch() {
    loading.value = true
    try {
      const res = await listPositions({ page_size: 100, status: 'active' })
      positions.value = res.data.items
    } catch {
      positions.value = []
    } finally {
      loading.value = false
    }
  }

  function getById(id: string): Position | undefined {
    return positions.value.find(p => p.id === id)
  }

  return { positions, loading, fetch, getById }
}
```

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0  
**æœ€åæ›´æ–°**: 2026-02-14  
**åç«¯ API ç‰ˆæœ¬**: v1
